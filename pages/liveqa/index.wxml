<view class="view-container" hidden="{{!user.myLiveSchool.name}}">
  <form bindsubmit="formSubmit" report-submit="true">
    <view class="title-and-schedule-container">
      <view class="cover" wx:if="{{live.status === 100 || live.status === 101}}">
        <button class="btn-round">
          <text>争夺战已经开始， 马上前往</text>
          <image class="icon-arrow-right" src="https://cdn.ailingual.cn/pics/liveqa/icon_arrow_right.png" />
        </button>
      </view>

      <!-- <view class="title-container">
        <image class="liveqa-title" src="https://cdn.ailingual.cn/pics/liveqa/qa_title2.png" />
      </view> -->

      <!-- <view class="schedule">
        <view class="timer">距离下场时间{{live.timeToNextLive}}</view>
        <view class="left">
          <view wx:for="{{live.schedule}}" wx:key class="list">
            <text class="label" style="background-color:{{item.bgColor}}">{{item.label}}</text>
            <text>{{item.time}}</text>
          </view>
        </view>
        <button class="right btn-round">预约</button>
      </view> -->
      <!-- <button class="btn-start" bindtap="startQA"> -->
      <button class="btn-start" formType="submit">
        <text class="size-18 block">开始答题</text>
        <!-- <text class="size-14 block">本周夺冠收益: ￥100,000</text> -->
      </button>
    </view>

    <view class="card-container">
      <view class="top-container" bindtap="gotoProfile">
        <image src="{{user.profilePicUrl}}" class="user-photo" />
        <view>
          <text>{{user.wxUsername}}</text>
          <text class="size-12"> (贡献: {{user.rtQAPointsThisWeek}}智商积分)</text>
        </view>
      </view>
      <view class="middle-container row" bindtap="gotoProfile">
        <view class="col left">
          <view class="text-dark-gray size-12">累计奖金</view>
          <text>
            <text>￥{{(user.rtCash / 100)}}</text>
          </text>
        </view>
        <view class="col">
          <view class="text-dark-gray size-12">学校排名</view>
          <view>第{{user.myLiveSchool.rtRanking}}名</view>
          <view class="size-12 text-dark-gray">{{user.myLiveSchool.name}}</view>
          <!-- <text>
            <text>第{{user.myLiveSchool.rtRanking}}名</text>
            <text class="size-12">（{{user.myLiveSchool.name}}）</text>
          </text> -->
        </view>
      </view>
      <view class="bottom-container">
        <text class="size-18">我拥有复活卡{{user.extraQALives || 0}}张</text>
        <button class="btn-round" bindtap="gotoSharedPoster">获得复活卡</button>
        <text class="size-12 text-gray">您的学校排名第{{user.myLiveSchool.rtRanking}}，赶紧拉好友一起参加</text>
      </view>
    </view>

    <navigator url="/pages/liveqa/rules" class="size-12 rule-link">活动规则</navigator>

    <view class="row leaderboard-type">
      <view class="size-18 title {{leaderboardType === 'schools' ? 'active' : ''}}" data-type="schools" bindtap="changeLeaderboard">学校排行榜</view>
      <view class="size-18 title {{leaderboardType === 'students' ? 'active' : ''}}" data-type="students" bindtap="changeLeaderboard">用户排行榜</view>
    </view>

    <view class="leaderboard size-12">
      <view class="table" hidden="{{leaderboardType !== 'schools'}}">
        <view class="text-red hint">
          <text hidden="{{!live.endAtDisplay}}">{{live.endAtDisplay}}</text>
          <text>排名前20的学校瓜分10万奖金</text>
        </view>

        <view class="table-head">
          <view class="table-row row">
            <text class="ranking">排名</text>
            <text>学校</text>
            <text>总智商积分</text>
          </view>
        </view>
        <view class="table-body">
          <view class="table-row row" wx:for="{{liveSchools}}" wx:key wx:for-item="school">
            <text class="ranking">{{index + 1}}</text>
            <text>{{school.name}}</text>
            <text>{{school.points}}</text>
          </view>
        </view>
      </view>

      <view class="table size-12" hidden="{{leaderboardType !== 'students'}}">
        <view class="table-head">
          <view class="table-row row">
            <text class="ranking">排名</text>
            <text>用户</text>
            <text>总智商积分</text>
          </view>
        </view>
        <view class="table-body">
          <view class="table-row row" wx:for="{{students}}" wx:key wx:for-item="student">
            <text class="ranking">{{index + 1}}</text>
            <text>{{student.wxUsername}}</text>
            <text>{{student.qaPoints}}</text>
          </view>
        </view>
      </view>

    </view>
  </form>
</view>

<view class="school-selector-view size-16" hidden="{{user.myLiveSchool.name}}">
    <view class="text-white">
      <text>选择你的学校, 开始答题</text>
    </view>
    <input type="text" placeholder="输入你的学校" bindinput="inputSchoolName" class="input-school-name" value="{{selectedSchool.name}}"/>

    <view class="school-list">
      <view wx:for="{{schoolList}}" wx:key="id" wx:for-item="school" hover-class="pressed" class="school-list-item" bindtap="selectSchool" data-item="{{school}}">{{school.name}}</view>
    </view>

    <button class="btn-round btn-success" disabled="{{!selectedSchool}}" bindtap="saveSelectedSchool">保存</button>
</view>

<view class="splash {{splashShown ? 'show' : ''}}">
  <image src="https://cdn.ailingual.cn/pics/liveqa/splash_fight.png" class="icon-splash-fight block" />
  <image src="https://cdn.ailingual.cn/pics/liveqa/fist_left.png" class="icon-fist icon-fist-left block" />
  <image src="https://cdn.ailingual.cn/pics/liveqa/fist_right.png" class="icon-fist icon-fist-right block" />
</view>
